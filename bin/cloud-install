#!/bin/sh

set -e

. /usr/share/cloud-installer/profiles/common.sh
. /usr/share/cloud-installer/profiles/maas.sh
. /usr/share/cloud-installer/profiles/juju.sh
. /usr/share/cloud-installer/profiles/multi.sh
. /usr/share/cloud-installer/profiles/single.sh

if [ ! -e /var/log/cloud-install.log ]; then
	touch /var/log/cloud-install.log
	chmod 0600 /var/log/cloud-install.log
fi
exec 2>> /var/log/cloud-install.log

trap exitInstall EXIT
trap "" PIPE

# FIXME: broken on apt-get installer tests
# disableBlank

if [ ! -e /etc/.cloud-installed ]; then
	db_get cloud-install/install-type
	case $RET in
            Multi-system)
		multiInstall
		;;
	    "Single system")
		singleInstall
		;;
	    "Landscape managed")
		;;
	esac
	touch /etc/.cloud-installed
fi
