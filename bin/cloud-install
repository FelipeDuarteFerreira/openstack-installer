#!/bin/sh

set -e

. /usr/share/cloud-install-common/common/common.sh
. /usr/share/cloud-install-common/common/maas.sh
. /usr/share/cloud-install-common/common/juju.sh
. /usr/share/cloud-install-common/common/multi.sh
. /usr/share/cloud-install-common/common/single.sh

# set universal default locale
export LANG=en_US.UTF-8
export LC_ALL=en_US.UTF-8

if [ ! -e /var/log/cloud-install.log ]; then
	touch /var/log/cloud-install.log
	chmod 0600 /var/log/cloud-install.log
fi
exec 2>> /var/log/cloud-install.log

trap exitInstall EXIT
trap "" PIPE

#disableBlank

if [ ! -e /etc/.cloud-installed ]; then
    db_get cloud-install/install-type
    case $RET in
	Multi-system)
	    multiInstall
	    ;;
	"Single system")
	    singleInstall
	    ;;
	"Landscape managed")
	    ;;
    esac
    touch /etc/.cloud-installed
fi

